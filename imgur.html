<!DOCTYPE html>
<html>

<head>
  <title>IMGUR TEST</title>
  <style>
  #dragandrophandler {
    border: 2px dotted #0B85A1;
    width: 400px;
    color: #92AAB0;
    text-align: left;
    vertical-align: middle;
    padding: 10px 10px 10 10px;
    margin-bottom: 10px;
    font-size: 200%;
  }
  </style>
</head>

<body>
  <div id="dragandrophandler">Drag & Drop Files Here</div>
  <div id="dragandrophandler" >
    <span class="custom-span">+</span>
    <p class="custom-para">Add Images</p>
    <input id="uploadBtn" type="file" class="upload" />
  </div>
  <input id="uploadFile" placeholder="0 files selected" disabled="disabled" />
  <br>
  <img id="displayImage" src="">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script>
  var imgur_client_id = "cffdbdcf9cb88c7";

  function allowDrop(ev) {
    ev.preventDefault();
  }

  function drag(ev) {
    ev.dataTransfer.setData("file", ev.target.id);
  }

  function drop(ev) {
    ev.preventDefault();
    console.log(this.value);
    var data = ev.dataTransfer.getData("file");
  }

  var obj = $("#dragandrophandler");
  obj.on('dragenter', function(e) {
    e.stopPropagation();
    e.preventDefault();
    $(this).css('border', '2px solid #0B85A1');
  });
  obj.on('dragover', function(e) {
    e.stopPropagation();
    e.preventDefault();
  });
  obj.on('drop', function(e) {

    $(this).css('border', '2px dotted #0B85A1');
    e.preventDefault();
    var files = e.originalEvent.dataTransfer.files;

    //We need to send dropped files to Server
    console.log(files);
    for (var i = 0; i < files.length; i++){
      readFile(files[i]);
    }
  });

  function readFile(file){
    console.log(file);
    var reader = new FileReader();
    reader.onloadend = function() {
      $("#displayImage").attr("src", reader.result);
      var base64result = reader.result.split(',')[1];
      var form = new FormData();
      form.append("image", base64result);

      var settings = {
        "async": true,
        "crossDomain": true,
        "url": "https://api.imgur.com/3/image",
        "method": "POST",
        "headers": {
          "authorization": `Client-ID ${imgur_client_id}`
        },
        "processData": false,
        "contentType": false,
        "mimeType": "multipart/form-data",
        "data": form
      }

      $.ajax(settings).done(function(response) {
        var res = JSON.parse(response);
        console.log(res.data.link);
      });
    }
    reader.readAsDataURL(file);
  }

  document.getElementById("uploadBtn").onchange  =   function (event)  {
    document.getElementById("uploadFile").value  =  this.value;
    console.log(event);
    console.log(this.value);
    var file = this.files[0];
    readFile(file);

  };
  </script>
</body>

</html>